<Window x:Class="modbus_master.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Modbus Master" Height="800" Width="1340" MinHeight="760" MinWidth="1100"
        WindowStyle="None" Background="Transparent" AllowsTransparency="True" ResizeMode="CanResizeWithGrip">

    <Window.Resources>
        <SolidColorBrush x:Key="TextBrush" Color="#F8F9FA" />
        <SolidColorBrush x:Key="SubTextBrush" Color="#CED4DA" />
        <SolidColorBrush x:Key="MutedTextBrush" Color="#6C757D" />

        <SolidColorBrush x:Key="BackgroundBrush" Color="#0A0B0D" />
        <SolidColorBrush x:Key="SurfaceBrush" Color="#1A1D23" />
        <SolidColorBrush x:Key="SurfaceAltBrush" Color="#212529" />
        <SolidColorBrush x:Key="SurfaceHoverBrush" Color="#2C3E50" />
        <SolidColorBrush x:Key="BorderBrush" Color="#495057" />
        <SolidColorBrush x:Key="BorderHoverBrush" Color="#6C7B7F" />
        <SolidColorBrush x:Key="PrimaryBrush" Color="#007FFF" />
        <SolidColorBrush x:Key="PrimaryHoverBrush" Color="#0066CC" />
        <SolidColorBrush x:Key="SuccessBrush" Color="#10B981" />
        <SolidColorBrush x:Key="ErrorBrush" Color="#EF4444" />


        <LinearGradientBrush x:Key="PrimaryGradient" StartPoint="0,0" EndPoint="0,1">
            <GradientStop Color="#007FFF" Offset="0" />
            <GradientStop Color="#0066CC" Offset="1" />
        </LinearGradientBrush>
        <LinearGradientBrush x:Key="SurfaceGradient" StartPoint="0,0" EndPoint="0,1">
            <GradientStop Color="#1A1D23" Offset="0" />
            <GradientStop Color="#16181C" Offset="1" />

        </LinearGradientBrush>
        <LinearGradientBrush x:Key="CardGradient" StartPoint="0,0" EndPoint="0,1">
            <GradientStop Color="#212529" Offset="0" />
            <GradientStop Color="#1C1F23" Offset="1" />
        </LinearGradientBrush>
        <DropShadowEffect x:Key="CardShadow" BlurRadius="20" ShadowDepth="4" Opacity="0.3" Color="#000000" />
        <DropShadowEffect x:Key="SoftShadow" BlurRadius="12" ShadowDepth="2" Opacity="0.2" Color="#000000" />
        <DropShadowEffect x:Key="GlowShadow" BlurRadius="15" ShadowDepth="0" Opacity="0.6" Color="#007FFF" />

        <Style TargetType="Button" x:Key="PrimaryButton">

            <Setter Property="Foreground" Value="{StaticResource TextBrush}" />
            <Setter Property="Background" Value="{StaticResource PrimaryGradient}" />
            <Setter Property="Padding" Value="16,8" />
            <Setter Property="FontSize" Value="13" />
            <Setter Property="FontWeight" Value="Medium" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Cursor" Value="Hand" />

            <Setter Property="Margin" Value="4" />
            <Setter Property="MinWidth" Value="80" />
            <Setter Property="MinHeight" Value="32" />
            <Setter Property="Effect" Value="{StaticResource SoftShadow}" />
            <Setter Property="Template">
                <Setter.Value>

                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="10"
                                Effect="{TemplateBinding Effect}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>

                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background"
                                        Value="{StaticResource PrimaryHoverBrush}" />

                                <Setter TargetName="border" Property="Effect" Value="{StaticResource GlowShadow}" />
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">

                                <Setter TargetName="border" Property="Background" Value="#0052A3" />
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="border" Property="Background"
                                        Value="{StaticResource MutedTextBrush}" />
                                <Setter TargetName="border" Property="Effect" Value="{x:Null}" />
                            </Trigger>
                        </ControlTemplate.Triggers>

                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style TargetType="Button" x:Key="GhostButton" BasedOn="{StaticResource PrimaryButton}">
            <Setter Property="Foreground" Value="{StaticResource SubTextBrush}" />
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderBrush" Value="{StaticResource 
 BorderBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Effect" Value="{x:Null}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">

                        <Border x:Name="border" Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="10">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>

                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background"
                                        Value="{StaticResource SurfaceHoverBrush}" />
                                <Setter TargetName="border" Property="BorderBrush"
                                        Value="{StaticResource BorderHoverBrush}" />

                                <Setter Property="Foreground" Value="{StaticResource TextBrush}" />
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">

                                <Setter TargetName="border" Property="Background" Value="{StaticResource SurfaceBrush}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>

                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="ToggleButton" x:Key="SegmentedToggleButton">
            <Setter Property="Foreground" Value="{StaticResource SubTextBrush}" />
            <Setter Property="Background" Value="{StaticResource SurfaceBrush}" />
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}" />
            <Setter Property="BorderThickness" Value="1" />

            <Setter Property="FontSize" Value="13" />
            <Setter Property="FontWeight" Value="Medium" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="MinHeight" Value="32" />
            <Setter Property="Template">
                <Setter.Value>

                    <ControlTemplate TargetType="ToggleButton">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"

                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="{TemplateBinding Tag}"
                                SnapsToDevicePixels="True">

                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>

                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="border" Property="Background"
                                        Value="{StaticResource PrimaryGradient}" />
                                <Setter TargetName="border" Property="BorderBrush"
                                        Value="{StaticResource PrimaryBrush}" />

                                <Setter Property="Foreground" Value="{StaticResource TextBrush}" />
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter
                                    TargetName="border" Property="BorderBrush"
                                    Value="{StaticResource BorderHoverBrush}" />
                                <Setter Property="Foreground" Value="{StaticResource TextBrush}" />
                            </Trigger>
                            <MultiTrigger>

                                <MultiTrigger.Conditions>
                                    <Condition Property="IsChecked" Value="False" />

                                    <Condition Property="IsMouseOver" Value="True" />
                                </MultiTrigger.Conditions>
                                <Setter TargetName="border" Property="Background"
                                        Value="{StaticResource SurfaceHoverBrush}" />
                            </MultiTrigger>

                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="TextBox">
            <Setter
                Property="Foreground" Value="{StaticResource TextBrush}" />
            <Setter Property="Background" Value="{StaticResource SurfaceBrush}" />
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Padding" Value="6,0" />
            <Setter Property="Height" Value="32" />
            <Setter Property="FontSize" Value="13" />

            <Setter Property="CaretBrush" Value="{StaticResource TextBrush}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border x:Name="border" Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="8">

                            <ScrollViewer x:Name="PART_ContentHost" Margin="{TemplateBinding Padding}"
                                          VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">

                                <Setter TargetName="border" Property="BorderBrush"
                                        Value="{StaticResource BorderHoverBrush}" />
                            </Trigger>
                            <Trigger Property="IsFocused" Value="True">

                                <Setter TargetName="border" Property="BorderBrush"
                                        Value="{StaticResource PrimaryBrush}" />
                                <Setter TargetName="border" Property="BorderThickness" Value="2" />
                                <Setter TargetName="border" Property="Effect" Value="{StaticResource GlowShadow}" />

                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>

        </Style>

        <Style TargetType="{x:Type ComboBox}">
            <Setter Property="Foreground" Value="{StaticResource TextBrush}" />
            <Setter Property="Background" Value="{StaticResource SurfaceBrush}" />
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Padding" Value="12,6" />

            <Setter Property="Height" Value="36" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBox">
                        <Grid>

                            <ToggleButton x:Name="ToggleButton" Focusable="false"
                                          IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                          Grid.Column="2">
                                <ToggleButton.Template>
                                    <ControlTemplate TargetType="ToggleButton">

                                        <Grid>
                                            <Border x:Name="border" Background="{StaticResource SurfaceBrush}"
                                                    BorderBrush="{StaticResource BorderBrush}" BorderThickness="1"
                                                    CornerRadius="8" />

                                            <Path x:Name="Arrow" Grid.Column="1" Fill="{StaticResource SubTextBrush}"
                                                  HorizontalAlignment="Right" VerticalAlignment="Center"
                                                  Margin="0,0,8,0" Data="M 0 0 L 4 4 L 8 0 Z" />
                                        </Grid>

                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">

                                                <Setter TargetName="border" Property="BorderBrush"
                                                        Value="{StaticResource BorderHoverBrush}" />
                                            </Trigger>

                                            <Trigger Property="IsChecked" Value="True">
                                                <Setter TargetName="border" Property="BorderBrush"
                                                        Value="{StaticResource PrimaryBrush}" />

                                                <Setter TargetName="border" Property="Effect"
                                                        Value="{StaticResource GlowShadow}" />
                                            </Trigger>
                                        </ControlTemplate.Triggers>

                                    </ControlTemplate>
                                </ToggleButton.Template>
                            </ToggleButton>

                            <ContentPresenter x:Name="ContentSite" IsHitTestVisible="False"
                                              Content="{TemplateBinding SelectionBoxItem}"
                                              ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                              ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                                              Margin="{TemplateBinding Padding}" VerticalAlignment="Center"
                                              HorizontalAlignment="Left" />
                            <Popup x:Name="Popup" Placement="Bottom" IsOpen="{TemplateBinding IsDropDownOpen}"
                                   AllowsTransparency="True" Focusable="False" PopupAnimation="Slide">

                                <Grid Name="DropDown" SnapsToDevicePixels="True"
                                      MinWidth="{TemplateBinding ActualWidth}"
                                      MaxHeight="{TemplateBinding MaxDropDownHeight}">
                                    <Border x:Name="DropDownBorder" Background="{StaticResource SurfaceAltBrush}"
                                            BorderThickness="1" BorderBrush="{StaticResource BorderBrush}"
                                            CornerRadius="8" Margin="0,4,0,0" />
                                    <ScrollViewer Margin="4" SnapsToDevicePixels="True">

                                        <StackPanel IsItemsHost="True"
                                                    KeyboardNavigation.DirectionalNavigation="Contained" />
                                    </ScrollViewer>

                                </Grid>
                            </Popup>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>

            </Setter>
        </Style>

        <Style TargetType="{x:Type ComboBoxItem}">
            <Setter Property="Foreground" Value="{StaticResource SubTextBrush}" />
            <Setter Property="Padding" Value="8,6" />
            <Setter Property="MinHeight" Value="30" />
            <Setter Property="Template">

                <Setter.Value>
                    <ControlTemplate TargetType="ComboBoxItem">
                        <Border x:Name="Bd" Padding="{TemplateBinding Padding}" Background="Transparent"
                                CornerRadius="4">
                            <ContentPresenter />

                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsHighlighted" Value="True">
                                <Setter TargetName="Bd" Property="Background"
                                        Value="{StaticResource SurfaceHoverBrush}" />

                                <Setter Property="Foreground" Value="{StaticResource TextBrush}" />
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">

                                <Setter TargetName="Bd" Property="Background" Value="{StaticResource BorderBrush}" />
                                <Setter Property="Foreground" Value="{StaticResource TextBrush}" />
                            </Trigger>

                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="DataGrid">
            <Setter Property="Background" Value="Transparent" />

            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="GridLinesVisibility" Value="Horizontal" />
            <Setter Property="HorizontalGridLinesBrush" Value="{StaticResource BorderBrush}" />
            <Setter Property="RowHeight" Value="48" />
            <Setter Property="HeadersVisibility" Value="Column" />
            <Setter Property="Foreground" Value="{StaticResource TextBrush}" />
            <Setter Property="FontSize" Value="13" />

            <Setter Property="RowBackground" Value="{StaticResource BorderBrush}" />
            <!-- <Setter Property="AlternatingRowBackground" Value="#0F1419" /> -->
            <Setter Property="CanUserAddRows" Value="False" />
            <Setter Property="CanUserDeleteRows" Value="False" />
            <Setter Property="AutoGenerateColumns" Value="False" />
        </Style>
        <Style TargetType="DataGridRow">
            <Setter Property="Background" Value="Transparent" />

            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="{StaticResource SurfaceHoverBrush}" />
                </Trigger>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="{StaticResource BorderBrush}" />
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style TargetType="DataGridCell" x:Key="CenteredCell">
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Padding" Value="8,6" />
            <Setter Property="HorizontalContentAlignment" Value="Center" />
            <Setter Property="VerticalContentAlignment" Value="Center" />
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Foreground" Value="{StaticResource TextBrush}" />
                    <Setter Property="Background" Value="Transparent" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="DataGridColumnHeader" x:Key="CenteredHeader">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Foreground" Value="{StaticResource MutedTextBrush}" />
            <Setter Property="Padding" Value="8,6" />
            <Setter Property="BorderThickness" Value="0,0,0,2" />
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="HorizontalContentAlignment" Value="Center" />
            <Setter Property="FontSize" Value="11" />
        </Style>

        <Style x:Key="SimpleBitToggleStyle" TargetType="ToggleButton">
            <Setter Property="Width" Value="28" />
            <Setter Property="Height" Value="28" />
            <Setter Property="Margin" Value="2" />
            <Setter Property="Background" Value="{StaticResource SurfaceBrush}" />
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Foreground" Value="{StaticResource MutedTextBrush}" />
            <Setter Property="FontSize" Value="11" />
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToggleButton">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="3">
                            <TextBlock x:Name="BitText"
                                       Text="0"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"
                                       Foreground="{TemplateBinding Foreground}"
                                       FontSize="{TemplateBinding FontSize}"
                                       FontWeight="{TemplateBinding FontWeight}" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter Property="Background" Value="{StaticResource PrimaryBrush}" />
                                <Setter Property="BorderBrush" Value="{StaticResource PrimaryBrush}" />
                                <Setter Property="Foreground" Value="{StaticResource TextBrush}" />
                                <Setter TargetName="BitText" Property="Text" Value="1" />
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="BorderBrush" Value="{StaticResource BorderHoverBrush}" />
                            </Trigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsChecked" Value="True" />
                                    <Condition Property="IsMouseOver" Value="True" />
                                </MultiTrigger.Conditions>
                                <Setter Property="Background" Value="{StaticResource PrimaryHoverBrush}" />
                                <Setter Property="BorderBrush" Value="{StaticResource PrimaryHoverBrush}" />
                            </MultiTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="BitToggleStyle" TargetType="ToggleButton">

            <Setter Property="Width" Value="22" />
            <Setter Property="Height" Value="22" />
            <Setter Property="Margin" Value="1,0" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToggleButton">

                        <Grid>
                            <Border x:Name="outerBorder" CornerRadius="11" Background="Transparent"
                                    BorderBrush="Transparent" BorderThickness="1" />
                            <Ellipse x:Name="indicator"

                                     Width="10" Height="10"
                                     HorizontalAlignment="Center" VerticalAlignment="Center"
                                     Stroke="{StaticResource MutedTextBrush}"

                                     StrokeThickness="1.5"
                                     Fill="Transparent" />
                        </Grid>

                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="indicator" Property="Fill" Value="{StaticResource PrimaryBrush}" />

                                <Setter TargetName="indicator" Property="Stroke" Value="{StaticResource PrimaryBrush}" />
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">

                                <Setter TargetName="outerBorder" Property="Background"
                                        Value="{StaticResource SurfaceHoverBrush}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>

            </Setter>
        </Style>
    </Window.Resources>

    <Border CornerRadius="15" Background="{StaticResource BackgroundBrush}" BorderBrush="{StaticResource BorderBrush}"
            BorderThickness="1" Effect="{StaticResource CardShadow}">
        <Grid>
            <Grid Background="{StaticResource SurfaceGradient}" Height="50" VerticalAlignment="Top"
                  MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition /><ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="20,0,0,0">

                    <TextBlock Text="⚡ Modbus Master" Foreground="{StaticResource TextBrush}" FontSize="18"
                               FontWeight="SemiBold" />
                    <Border Margin="16,0,0,0" Padding="12,4" CornerRadius="20"
                            Background="{StaticResource CardGradient}" BorderBrush="{StaticResource BorderBrush}"
                            BorderThickness="1">
                        <StackPanel Orientation="Horizontal">

                            <Ellipse x:Name="elConn" Width="10" Height="10" Margin="0,0,8,0"
                                     Fill="{StaticResource ErrorBrush}" />
                            <TextBlock x:Name="lblConn" Text="Disconnected" Foreground="{StaticResource SubTextBrush}"
                                       FontSize="13" FontWeight="Medium" />
                        </StackPanel>
                    </Border>

                    <Border Margin="16,0,0,0" Padding="12,4" CornerRadius="20"
                            Background="{StaticResource CardGradient}" BorderBrush="{StaticResource BorderBrush}"
                            BorderThickness="1">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="RTT:" Foreground="{StaticResource MutedTextBrush}" FontSize="12"
                                       Margin="0,0,4,0" />

                            <TextBlock x:Name="lblRttLast" Text="-" Foreground="{StaticResource TextBrush}"
                                       FontWeight="Medium" FontSize="12" Margin="0,0,12,0" />
                            <TextBlock Text="Avg:" Foreground="{StaticResource MutedTextBrush}" FontSize="12"
                                       Margin="0,0,4,0" />
                            <TextBlock x:Name="lblRttAvg" Text="-" Foreground="{StaticResource TextBrush}"
                                       FontWeight="Medium" FontSize="12" Margin="0,0,12,0" />

                            <TextBlock Text="OK:" Foreground="{StaticResource MutedTextBrush}" FontSize="12"
                                       Margin="0,0,4,0" />
                            <TextBlock x:Name="lblOk" Text="0" Foreground="{StaticResource SuccessBrush}"
                                       FontWeight="Medium" FontSize="12" Margin="0,0,12,0" />
                            <TextBlock Text="Err:" Foreground="{StaticResource MutedTextBrush}" FontSize="12"
                                       Margin="0,0,4,0" />

                            <TextBlock x:Name="lblErr" Text="0" Foreground="{StaticResource ErrorBrush}"
                                       FontWeight="Medium" FontSize="12" />
                        </StackPanel>
                    </Border>
                </StackPanel>
                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,12,0">

                    <Button Style="{StaticResource GhostButton}" Width="32" Height="28" Content="—"
                            Click="Minimize_Click" Padding="0" Margin="1" MinWidth="32" FontSize="12" />
                    <Button Style="{StaticResource GhostButton}" Width="32" Height="28" Content="□"
                            Click="Maximize_Click" Padding="0" Margin="1" MinWidth="32" FontSize="12" />
                    <Button Style="{StaticResource GhostButton}" Width="32" Height="28" Content="✕" Click="Close_Click"
                            Padding="0" Margin="1" MinWidth="32" FontSize="12" />
                </StackPanel>

            </Grid>

            <Grid Margin="0,50,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="380" /> <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <Border Grid.Column="0" Background="{StaticResource SurfaceGradient}"
                        BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,1,0">

                    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="8">
                        <StackPanel Margin="12">
                            <Border Background="{StaticResource CardGradient}" CornerRadius="12" Padding="20"
                                    Margin="0,0,0,12" Effect="{StaticResource CardShadow}"
                                    BorderBrush="{StaticResource BorderBrush}" BorderThickness="1">

                                <StackPanel>
                                    <TextBlock Text="🌐 Connection" Foreground="{StaticResource TextBrush}"
                                               FontWeight="SemiBold" FontSize="16" Margin="0,0,0,16" />
                                    <Grid Margin="0,0,0,8">

                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />

                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" /><ColumnDefinition Width="90" />
                                            <ColumnDefinition Width="70" />
                                        </Grid.ColumnDefinitions>

                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="IP"
                                                   Foreground="{StaticResource SubTextBrush}" FontSize="12"
                                                   Margin="6,0,0,4" />
                                        <TextBox x:Name="txtIp" Grid.Row="1" Grid.Column="0" Text="192.168.0.50"
                                                 ToolTip="IP Address" />

                                        <TextBlock Grid.Row="0" Grid.Column="1" Text="Port"
                                                   Foreground="{StaticResource SubTextBrush}" FontSize="12"
                                                   Margin="6,0,0,4" />
                                        <TextBox x:Name="txtPort" Grid.Row="1" Grid.Column="1" Text="502"
                                                 Margin="4,0,0,0" ToolTip="Port" />

                                        <TextBlock Grid.Row="0" Grid.Column="2" Text="Unit ID"
                                                   Foreground="{StaticResource SubTextBrush}" FontSize="12"
                                                   Margin="6,0,0,4" />
                                        <TextBox x:Name="txtUnitId" Grid.Row="1" Grid.Column="2" Text="1"
                                                 Margin="4,0,0,0" ToolTip="Unit ID" />

                                    </Grid>
                                    <CheckBox x:Name="chkAutoReconnect" Content="Auto Reconnect" IsChecked="True"
                                              Foreground="{StaticResource SubTextBrush}" Margin="0,8,0,8" />
                                    <Button x:Name="btnToggleConnect" Click="btnToggleConnect_Click"
                                            Style="{StaticResource PrimaryButton}" />

                                </StackPanel>
                            </Border>

                            <Border Background="{StaticResource CardGradient}" CornerRadius="12" Padding="4"
                                    Effect="{StaticResource CardShadow}" BorderBrush="{StaticResource BorderBrush}"
                                    BorderThickness="1">

                                <Grid>
                                    <Grid.RowDefinitions>

                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="*" />
                                    </Grid.RowDefinitions>

                                    <Border Grid.Row="0" Background="{StaticResource SurfaceBrush}" CornerRadius="8"
                                            Padding="4" Margin="16,16,16,12">
                                        <Grid>

                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" />

                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <ToggleButton x:Name="ReadToggle" Grid.Column="0" Content="📖 Read"
                                                          Style="{StaticResource SegmentedToggleButton}"
                                                          Tag="8,0,0,8" IsChecked="True" Checked="ReadToggle_Checked" />
                                            <ToggleButton x:Name="WriteToggle" Grid.Column="1" Content="✏️ Write"
                                                          Style="{StaticResource SegmentedToggleButton}" Tag="0,8,8,0"
                                                          Checked="WriteToggle_Checked" />
                                        </Grid>

                                    </Border>


                                    <Grid x:Name="ReadSettingsPanel" Grid.Row="1" Margin="20,0,20,20"
                                          Visibility="Visible">
                                        <StackPanel>
                                            <ComboBox x:Name="cmbFunction" SelectedIndex="2" Margin="0,0,0,8">

                                                <ComboBoxItem Content="FC1 - Read Coils" />
                                                <ComboBoxItem Content="FC2 - Read Discrete Inputs" />

                                                <ComboBoxItem Content="FC3 - Read Holding Registers" />

                                                <ComboBoxItem Content="FC4 - Read Input Registers" />
                                            </ComboBox>
                                            <Grid Margin="0,0,0,8">

                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition /><ColumnDefinition />
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>

                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />

                                                </Grid.RowDefinitions>
                                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Start Register"
                                                           Foreground="{StaticResource SubTextBrush}" FontSize="12"
                                                           Margin="0,0,0,4" />
                                                <TextBlock Grid.Row="0" Grid.Column="1" Text="Count"
                                                           Foreground="{StaticResource SubTextBrush}" FontSize="12"
                                                           Margin="2,0,0,4" />

                                                <TextBox Grid.Row="1" Grid.Column="0" x:Name="txtStart" Text="0"
                                                         ToolTip="Start Address" Margin="0,0,2,0" />
                                                <TextBox Grid.Row="1" Grid.Column="1" x:Name="txtCount" Text="10"
                                                         ToolTip="Count" Margin="2,0,0,0" />

                                            </Grid>
                                            <StackPanel Margin="0,0,0,8">

                                                <TextBlock Text="Poll Period (ms)"
                                                           Foreground="{StaticResource SubTextBrush}" FontSize="12"
                                                           Margin="0,0,0,4" />
                                                <TextBox x:Name="txtPeriod" Text="2000" ToolTip="Poll Period (ms)" />

                                            </StackPanel>
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center"
                                                        Margin="0,16,0,0">

                                                <Button x:Name="btnReadOnce" Content="Read Once"
                                                        Click="btnReadOnce_Click" Style="{StaticResource GhostButton}" />
                                                <Button x:Name="btnStart" Click="btnStart_Click"
                                                        Style="{StaticResource PrimaryButton}" Content="▶ Start" />

                                                <Button x:Name="btnStop" Click="btnStop_Click"
                                                        Style="{StaticResource GhostButton}" Content="■ Stop" />
                                            </StackPanel>
                                        </StackPanel>

                                    </Grid>

                                    <Grid x:Name="WriteSettingsPanel" Grid.Row="1" Margin="20,0,20,20"
                                          Visibility="Collapsed">

                                        <StackPanel>
                                            <ComboBox x:Name="cmbWriteType" SelectedIndex="1" Margin="0,0,0,8">

                                                <ComboBoxItem Content="FC5 - Single Coil" />
                                                <ComboBoxItem Content="FC6 - Holding Register" />
                                            </ComboBox>

                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition /><ColumnDefinition />
                                                </Grid.ColumnDefinitions>

                                                <TextBox Grid.Column="0" x:Name="txtWriteAddr" Text="0"
                                                         ToolTip="Address" Margin="0,0,2,0" />
                                                <TextBox Grid.Column="1" x:Name="txtWriteValue" Text="1"
                                                         ToolTip="Value" Margin="2,0,0,0" />

                                            </Grid>
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center"
                                                        Margin="0,16,0,0">
                                                <Button Content="Use Selected" Click="btnUseSelected_Click"
                                                        Style="{StaticResource GhostButton}" />
                                                <Button x:Name="btnWrite" Click="btnWrite_Click"
                                                        Style="{StaticResource PrimaryButton}" Content="Send Write" />

                                            </StackPanel>
                                        </StackPanel>
                                    </Grid>

                                </Grid>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </Border>


                <Grid Grid.Column="1">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />   <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <Border Grid.Row="0" Margin="12,12,12,6" Background="{StaticResource CardGradient}"
                            CornerRadius="12" Padding="12" BorderBrush="{StaticResource BorderBrush}"
                            BorderThickness="1">

                        <DockPanel>
                            <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="4,0,0,8">
                                <TextBlock Text="📊 Data Monitor" VerticalAlignment="Center" FontWeight="SemiBold"
                                           FontSize="16" Foreground="{StaticResource TextBrush}" />

                                <Button x:Name="btnExport" Content="Export" Click="btnExport_Click"
                                        Style="{StaticResource GhostButton}" Padding="12,6" Margin="12,0,0,0"
                                        FontSize="12" />
                                <Button x:Name="btnClear" Content="Clear" Click="btnClear_Click"
                                        Style="{StaticResource GhostButton}" Padding="12,6" Margin="4,0,0,0"
                                        FontSize="12" />
                            </StackPanel>

                            <DataGrid x:Name="dgData" IsReadOnly="False" MouseDoubleClick="dgData_MouseDoubleClick"
                                      GridLinesVisibility="None" ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Addr" Binding="{Binding Address}" Width="0.7*"
                                                        IsReadOnly="True">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Center" />
                                                <Setter Property="VerticalAlignment" Value="Center" />
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                        <DataGridTextColumn.HeaderStyle>
                                            <Style TargetType="DataGridColumnHeader"
                                                   BasedOn="{StaticResource CenteredHeader}" />
                                        </DataGridTextColumn.HeaderStyle>
                                    </DataGridTextColumn>

                                    <DataGridTextColumn Header="Dec" Binding="{Binding Value}" Width="0.7*"
                                                        IsReadOnly="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Center" />
                                                <Setter Property="VerticalAlignment" Value="Center" />
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                        <DataGridTextColumn.EditingElementStyle>
                                            <Style TargetType="TextBox">
                                                <Setter Property="TextAlignment" Value="Center" />
                                            </Style>
                                        </DataGridTextColumn.EditingElementStyle>
                                        <DataGridTextColumn.HeaderStyle>
                                            <Style TargetType="DataGridColumnHeader"
                                                   BasedOn="{StaticResource CenteredHeader}" />
                                        </DataGridTextColumn.HeaderStyle>
                                    </DataGridTextColumn>

                                    <DataGridTextColumn Header="Hex" Binding="{Binding ValueHex}" Width="0.8*"
                                                        IsReadOnly="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Center" />
                                                <Setter Property="VerticalAlignment" Value="Center" />
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                        <DataGridTextColumn.EditingElementStyle>
                                            <Style TargetType="TextBox">
                                                <Setter Property="TextAlignment" Value="Center" />
                                            </Style>
                                        </DataGridTextColumn.EditingElementStyle>
                                        <DataGridTextColumn.HeaderStyle>
                                            <Style TargetType="DataGridColumnHeader"
                                                   BasedOn="{StaticResource CenteredHeader}" />
                                        </DataGridTextColumn.HeaderStyle>
                                    </DataGridTextColumn>

                                    <!-- 16개의 Bit 컬럼들 -->
                                    <DataGridTemplateColumn Header="15" Width="0.4*">
                                        <DataGridTemplateColumn.HeaderStyle>
                                            <Style TargetType="DataGridColumnHeader"
                                                   BasedOn="{StaticResource CenteredHeader}" />
                                        </DataGridTemplateColumn.HeaderStyle>
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <ToggleButton
                                                    IsChecked="{Binding Bit15, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    Style="{StaticResource SimpleBitToggleStyle}" />
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>

                                    <DataGridTemplateColumn Header="14" Width="0.4*">
                                        <DataGridTemplateColumn.HeaderStyle>
                                            <Style TargetType="DataGridColumnHeader"
                                                   BasedOn="{StaticResource CenteredHeader}" />
                                        </DataGridTemplateColumn.HeaderStyle>
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <ToggleButton
                                                    IsChecked="{Binding Bit14, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    Style="{StaticResource SimpleBitToggleStyle}" />
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>

                                    <DataGridTemplateColumn Header="13" Width="0.4*">
                                        <DataGridTemplateColumn.HeaderStyle>
                                            <Style TargetType="DataGridColumnHeader"
                                                   BasedOn="{StaticResource CenteredHeader}" />
                                        </DataGridTemplateColumn.HeaderStyle>
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <ToggleButton
                                                    IsChecked="{Binding Bit13, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    Style="{StaticResource SimpleBitToggleStyle}" />
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>

                                    <DataGridTemplateColumn Header="12" Width="0.4*">
                                        <DataGridTemplateColumn.HeaderStyle>
                                            <Style TargetType="DataGridColumnHeader"
                                                   BasedOn="{StaticResource CenteredHeader}" />
                                        </DataGridTemplateColumn.HeaderStyle>
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <ToggleButton
                                                    IsChecked="{Binding Bit12, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    Style="{StaticResource SimpleBitToggleStyle}" />
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>

                                    <DataGridTemplateColumn Header="11" Width="0.4*">
                                        <DataGridTemplateColumn.HeaderStyle>
                                            <Style TargetType="DataGridColumnHeader"
                                                   BasedOn="{StaticResource CenteredHeader}" />
                                        </DataGridTemplateColumn.HeaderStyle>
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <ToggleButton
                                                    IsChecked="{Binding Bit11, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    Style="{StaticResource SimpleBitToggleStyle}" />
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>

                                    <DataGridTemplateColumn Header="10" Width="0.4*">
                                        <DataGridTemplateColumn.HeaderStyle>
                                            <Style TargetType="DataGridColumnHeader"
                                                   BasedOn="{StaticResource CenteredHeader}" />
                                        </DataGridTemplateColumn.HeaderStyle>
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <ToggleButton
                                                    IsChecked="{Binding Bit10, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    Style="{StaticResource SimpleBitToggleStyle}" />
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>

                                    <DataGridTemplateColumn Header="9" Width="0.4*">
                                        <DataGridTemplateColumn.HeaderStyle>
                                            <Style TargetType="DataGridColumnHeader"
                                                   BasedOn="{StaticResource CenteredHeader}" />
                                        </DataGridTemplateColumn.HeaderStyle>
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <ToggleButton
                                                    IsChecked="{Binding Bit9, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    Style="{StaticResource SimpleBitToggleStyle}" />
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>

                                    <DataGridTemplateColumn Header="8" Width="0.4*">
                                        <DataGridTemplateColumn.HeaderStyle>
                                            <Style TargetType="DataGridColumnHeader"
                                                   BasedOn="{StaticResource CenteredHeader}" />
                                        </DataGridTemplateColumn.HeaderStyle>
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <ToggleButton
                                                    IsChecked="{Binding Bit8, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    Style="{StaticResource SimpleBitToggleStyle}" />
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>

                                    <DataGridTemplateColumn Header="7" Width="0.4*">
                                        <DataGridTemplateColumn.HeaderStyle>
                                            <Style TargetType="DataGridColumnHeader"
                                                   BasedOn="{StaticResource CenteredHeader}" />
                                        </DataGridTemplateColumn.HeaderStyle>
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <ToggleButton
                                                    IsChecked="{Binding Bit7, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    Style="{StaticResource SimpleBitToggleStyle}" />
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>

                                    <DataGridTemplateColumn Header="6" Width="0.4*">
                                        <DataGridTemplateColumn.HeaderStyle>
                                            <Style TargetType="DataGridColumnHeader"
                                                   BasedOn="{StaticResource CenteredHeader}" />
                                        </DataGridTemplateColumn.HeaderStyle>
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <ToggleButton
                                                    IsChecked="{Binding Bit6, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    Style="{StaticResource SimpleBitToggleStyle}" />
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>

                                    <DataGridTemplateColumn Header="5" Width="0.4*">
                                        <DataGridTemplateColumn.HeaderStyle>
                                            <Style TargetType="DataGridColumnHeader"
                                                   BasedOn="{StaticResource CenteredHeader}" />
                                        </DataGridTemplateColumn.HeaderStyle>
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <ToggleButton
                                                    IsChecked="{Binding Bit5, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    Style="{StaticResource SimpleBitToggleStyle}" />
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>

                                    <DataGridTemplateColumn Header="4" Width="0.4*">
                                        <DataGridTemplateColumn.HeaderStyle>
                                            <Style TargetType="DataGridColumnHeader"
                                                   BasedOn="{StaticResource CenteredHeader}" />
                                        </DataGridTemplateColumn.HeaderStyle>
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <ToggleButton
                                                    IsChecked="{Binding Bit4, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    Style="{StaticResource SimpleBitToggleStyle}" />
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>

                                    <DataGridTemplateColumn Header="3" Width="0.4*">
                                        <DataGridTemplateColumn.HeaderStyle>
                                            <Style TargetType="DataGridColumnHeader"
                                                   BasedOn="{StaticResource CenteredHeader}" />
                                        </DataGridTemplateColumn.HeaderStyle>
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <ToggleButton
                                                    IsChecked="{Binding Bit3, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    Style="{StaticResource SimpleBitToggleStyle}" />
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>

                                    <DataGridTemplateColumn Header="2" Width="0.4*">
                                        <DataGridTemplateColumn.HeaderStyle>
                                            <Style TargetType="DataGridColumnHeader"
                                                   BasedOn="{StaticResource CenteredHeader}" />
                                        </DataGridTemplateColumn.HeaderStyle>
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <ToggleButton
                                                    IsChecked="{Binding Bit2, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    Style="{StaticResource SimpleBitToggleStyle}" />
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>

                                    <DataGridTemplateColumn Header="1" Width="0.4*">
                                        <DataGridTemplateColumn.HeaderStyle>
                                            <Style TargetType="DataGridColumnHeader"
                                                   BasedOn="{StaticResource CenteredHeader}" />
                                        </DataGridTemplateColumn.HeaderStyle>
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <ToggleButton
                                                    IsChecked="{Binding Bit1, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    Style="{StaticResource SimpleBitToggleStyle}" />
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>

                                    <DataGridTemplateColumn Header="0" Width="0.4*">
                                        <DataGridTemplateColumn.HeaderStyle>
                                            <Style TargetType="DataGridColumnHeader"
                                                   BasedOn="{StaticResource CenteredHeader}" />
                                        </DataGridTemplateColumn.HeaderStyle>
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <ToggleButton
                                                    IsChecked="{Binding Bit0, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    Style="{StaticResource SimpleBitToggleStyle}" />
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>

                                    <DataGridTextColumn Header="String" Binding="{Binding ValueString}" Width="1*"
                                                        IsReadOnly="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Center" />
                                                <Setter Property="VerticalAlignment" Value="Center" />
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                        <DataGridTextColumn.EditingElementStyle>
                                            <Style TargetType="TextBox">
                                                <Setter Property="TextAlignment" Value="Center" />
                                            </Style>
                                        </DataGridTextColumn.EditingElementStyle>
                                        <DataGridTextColumn.HeaderStyle>
                                            <Style TargetType="DataGridColumnHeader"
                                                   BasedOn="{StaticResource CenteredHeader}" />
                                        </DataGridTextColumn.HeaderStyle>
                                    </DataGridTextColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </DockPanel>
                    </Border>


                    <Border Grid.Row="1" Margin="12,6,12,12" Background="{StaticResource CardGradient}"
                            CornerRadius="12" Padding="12" BorderBrush="{StaticResource BorderBrush}"
                            BorderThickness="1">
                        <DockPanel>
                            <StackPanel
                                DockPanel.Dock="Top" Orientation="Horizontal" Margin="4,0,0,8">
                                <TextBlock Text="📝 Event Log" VerticalAlignment="Center" FontWeight="SemiBold"
                                           FontSize="16" Foreground="{StaticResource TextBrush}" />
                                <Button Content="Copy" Click="btnCopyLog_Click" Style="{StaticResource GhostButton}"
                                        Padding="12,6" Margin="12,0,0,0" FontSize="12" />

                                <Button Content="Clear" Click="btnClearLog_Click" Style="{StaticResource GhostButton}"
                                        Padding="12,6" Margin="4,0,0,0" FontSize="12" />
                            </StackPanel>
                            <TextBox x:Name="txtLog" TextWrapping="Wrap" AcceptsReturn="True" IsReadOnly="True"

                                     VerticalScrollBarVisibility="Auto" FontFamily="Consolas" FontSize="12"
                                     Background="Transparent" BorderThickness="0"

                                     Height="Auto" VerticalAlignment="Stretch" />
                        </DockPanel>
                    </Border>
                </Grid>
            </Grid>
        </Grid>
    </Border>
</Window>